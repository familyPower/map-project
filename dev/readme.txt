Important: I borrowed snippets of code from various websites. 
